<div style="display: flex; flex-wrap: wrap" class="product-carousel-wrapper-side">
  <div class="custom-column">
    <div style="position: relative;" class="best-sellers">
      <h1 style="color: white; font: 'Poppins', sans-serif;">{{ section.settings.collection.title | upcase }}</h1>
      <a class="text-view" href="{{ section.settings.collection.url }}"
        >VIEW ALL <i class="fa fa-angle-right" aria-hidden="true"></i
      ></a>
    </div>
  </div>
  <div class="custom-wide-column">
    <button class="owl-prev-custom-side"><i class="fa fa-angle-left"></i></button>

    <div class="owl-carousel">
      {% for product in section.settings.collection.products %}
        {% assign first_variant = product.variants.first %}
        {% assign original_price = first_variant.compare_at_price %}
        {% assign sale_price = first_variant.price %}
        <div class="item product-card">
          <a href="{{ product.url }}">
            <div class="image-wrapper">
              {% if original_price > sale_price %}
                {% assign discount = 100 | times: sale_price | divided_by: original_price | minus: 100 | round %}
                <div class="sale-badge">{{ discount | abs }}% OFF</div>
              {% endif %}
              <img
                srcset="
                  {%- if product.featured_media.width >= 165 -%}{{ product.featured_media | image_url: width: 165 }} 165w,{%- endif -%}
                  {%- if product.featured_media.width >= 360 -%}{{ product.featured_media | image_url: width: 360 }} 360w,{%- endif -%}
                  {%- if product.featured_media.width >= 533 -%}{{ product.featured_media | image_url: width: 533 }} 533w,{%- endif -%}
                  {%- if product.featured_media.width >= 720 -%}{{ product.featured_media | image_url: width: 720 }} 720w,{%- endif -%}
                  {%- if product.featured_media.width >= 940 -%}{{ product.featured_media | image_url: width: 940 }} 940w,{%- endif -%}
                  {%- if product.featured_media.width >= 1066 -%}{{ product.featured_media | image_url: width: 1066 }} 1066w,{%- endif -%}
                  {{ product.featured_media | image_url }} {{ product.featured_media.width }}w
                "
                src="{{ product.featured_media | image_url: width: 533 }}"
                sizes="(min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 130 | divided_by: 4 }}px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)"
                alt="{{ product.featured_media.alt | escape }}"
                class="motion-reduce"
                {% unless lazy_load == false %}
                  loading="lazy"
                {% endunless %}
                width="{{ product.featured_media.width }}"
                height="{{ product.featured_media.height }}"
              >
            </div>
            <div class="product-info">
              <p class="product-title">{{ product.title }}</p>
              <div class="product-price">
                <span class="sale-price">{{ sale_price | money }}</span>
                {% if original_price > sale_price %}
                  <span class="compare-price">{{ original_price | money }}</span>
                {% endif %}
              </div>
            </div>
          </a>
        </div>
        {% if original_price > sale_price %}
          {% assign discount = 100 | times: sale_price | divided_by: original_price | minus: 100 | round %}
          <div class="flag-sale d-flex">
            <div class="flag-product sale">sale</div>
            <div class="flag-product off">{{ discount | abs }}%</div>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <button class="owl-next-custom-side"><i class="fa fa-angle-right"></i></button>
  </div>
</div>

<style>
  .product-carousel-wrapper-side {
    position: relative;
    padding: 20px 0;
  }

  .owl-carousel .item {
    text-align: center;
    padding: 10px;
  }

  .owl-carousel .item img {
    max-width: 100%;
    height: auto;
    display: block;
    margin: 0 auto 10px;
  }

  .owl-prev-custom-side,
  .owl-next-custom-side {
    position: absolute;
    cursor: pointer;
    background-color: #f5f5f5;
    color: #9d9d9d;
    line-height: 12px;
    padding: 0;
    width: 50px;
    top: 50%;
    height: 50px;
    border-radius: 50%;
    border: none !important;
    box-shadow: 0px 0px 16px rgb(107, 107, 107, 0.34);
    font-size: 29px;
    transition: all 0.4s ease-in-out;
    outline: 0 !important;
    z-index: 9;
    opacity: 0.6;
  }

  .owl-prev-custom-side {
    left: 3%;
  }

  .owl-next-custom-side {
    right: 3%;
  }

  /* Large screens (≥992px) */
  @media (min-width: 992px) {
    .owl-prev-custom-side,
    .owl-next-custom-side {
      top: 40%;
    }

    .owl-prev-custom-side {
      left: 15%;
    }

    .owl-next-custom-side {
      right: 1.5%;
    }
  }

  .owl-prev-custom-side:hover,
  .owl-next-custom-side:hover {
    opacity: 1;
    background-color: #be1623;
    color: #fff;
  }

  .owl-prev-custom-side,
  .owl-next-custom-side {
    transition: all 0.4s ease-in-out;
  }

  .product-card {
    text-align: center;
    padding: 10px;
    position: relative;
  }

  .image-wrapper {
    position: relative;
  }

  .sale-badge {
    position: absolute;
    top: 8px;
    left: 8px;
    background: none;
    color: #d00;
    font-weight: bold;
    font-size: 14px;
  }

  .product-info {
    margin-top: 10px;
  }

  .product-title {
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    margin-bottom: 6px;
  }

  .product-price {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
  }

  .sale-price {
    font-size: 16px;
    font-weight: 500;
    color: #111;
  }

  .compare-price {
    font-size: 14px;
    color: #888;
    text-decoration: line-through;
  }

  /* Reset link styles inside product cards */
  .product-card a {
    text-decoration: none;
    color: inherit;
  }

  /* Title styling */
  .product-card .product-title {
    font-size: 14px;
    font-weight: 600;
    text-transform: uppercase;
    margin-bottom: 6px;
    color: #000; /* force black like your design */
    transition: color 0.3s ease;
  }

  /* Price styling */
  .product-card .product-price {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 8px;
  }

  .product-card .sale-price {
    font-size: 16px;
    font-weight: 500;
    color: #111;
  }

  .product-card .compare-price {
    font-size: 14px;
    color: #888;
    text-decoration: line-through;
  }

  /* Hover effect for title and price */
  .product-card:hover .product-title,
  .product-card:hover .sale-price {
    color: #be1623;
  }

  .custom-column {
    margin-bottom: 1rem; /* Same as Bootstrap's mb-3 */

    /* Responsive column widths */
    width: 100%; /* Default full width */

    /* Medium screens (≥768px) */
    @media (min-width: 768px) {
      width: 25%; /* col-md-3 = 3/12 columns = 25% */
    }

    /* Large screens (≥992px) */
    @media (min-width: 992px) {
      width: 16.6667%; /* col-lg-2 = 2/12 columns = 16.6667% */
    }
  }

  .custom-wide-column {
    width: 100%; /* Default full width on small screens */

    /* Medium screens (≥768px) */
    @media (min-width: 768px) {
      width: 75%; /* col-md-9 = 9/12 = 75% */
    }

    /* Large screens (≥992px) */
    @media (min-width: 992px) {
      width: 83.3333%; /* col-lg-10 = 10/12 = 83.3333% */
    }
  }

  .best-sellers {
    background-color: #020204;
    min-height: initial !important;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: space-between;
  }
  .best-sellers {
    box-shadow: 0px 0px 16px rgb(107, 107, 107, 0.34);
    padding: 19px 12px;
  }
  .best-sellers a {
    text-decoration: none;
  }
  .text-view {
    color: #be1623;
  }
  .text-view:hover {
    color: #fff;
  }

  @media (max-width: 767px) {
    .best-sellers {
      max-width: 50%;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: end;
    }
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    var $carousel = $('.owl-carousel');

    $carousel.owlCarousel({
      loop: true,
      margin: 10,
      nav: false,
      dots: false,
      autoplay: true,
      autoplayTimeout: 3000,
      autoplayHoverPause: true,
      smartSpeed: 600,
      responsive: {
        0: {
          items: 1,
        },
        768: {
          items: {{ section.settings.no_of_items }},
        }
      },
    });

    $('.owl-prev-custom-side').on('click', function () {
      $carousel.trigger('prev.owl.carousel');
    });

    $('.owl-next-custom-side').on('click', function () {
      $carousel.trigger('next.owl.carousel');
    });
  });
</script>

{% schema %}
{
  "name": "Carousel With Side",
  "settings": [
    {
      "type": "collection",
      "id": "collection",
      "label": "Collection"
    },
    {
      "type": "range",
      "min": 1,
      "max": 4,
      "step": 1,
      "label": "Number Of Items",
      "id": "no_of_items",
      "default": 4
    }
  ],
  "presets": [
    {
      "name": "Product Carousel"
    }
  ]
}
{% endschema %}
